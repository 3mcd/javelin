<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>Javelin Docs</title>

      
      <script src="/javelin-ecs.bundle.min.js" type="text/javascript"></script>
      

      <!-- CSS -->
      
      <link rel="preconnect" href="https://fonts.gstatic.com">
      <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="https://javelin.games/book.css">
      

      
      
    </head>

    <body>
        <header>
          <section>
            <nav>
              <a class="fat" href="/introduction"><h1>Javelin</h1></a>
              <a class="version" href="https:&#x2F;&#x2F;github.com&#x2F;3mcd&#x2F;javelin/releases/tag/v0.21.0">v0.21.0</a>
            </nav>
            <nav>
              <a class="fat disabled" href="#">API Docs</a>
              <a class="fat" href="https:&#x2F;&#x2F;github.com&#x2F;3mcd&#x2F;javelin">GitHub</a>
            </nav>
          </section>
        </header>
        <main>
          <section>
            <div class="menu">
                
                
                <nav role="navigation">
                    <ul>
                        
                            
                            
                                
                                <li >
                                    
                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;introduction&#x2F;">
                                        <span>1. </span>
                                        <strong>Introduction</strong>
                                    </a>
                                    
                                </li>
                            
                                
                                <li class="active">
                                    
                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;ecs&#x2F;">
                                        <span>2. </span>
                                        <strong>ECS</strong>
                                    </a>
                                    
                                        <ul>
                                            
                                                <li >
                                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;ecs&#x2F;world&#x2F;">
                                                        
                                                        World
                                                    </a>
                                                </li>
                                            
                                                <li >
                                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;ecs&#x2F;components&#x2F;">
                                                        
                                                        Components
                                                    </a>
                                                </li>
                                            
                                                <li >
                                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;ecs&#x2F;entities&#x2F;">
                                                        
                                                        Entities
                                                    </a>
                                                </li>
                                            
                                                <li >
                                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;ecs&#x2F;systems&#x2F;">
                                                        
                                                        Systems
                                                    </a>
                                                </li>
                                            
                                                <li >
                                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;ecs&#x2F;effects&#x2F;">
                                                        
                                                        Effects
                                                    </a>
                                                </li>
                                            
                                                <li >
                                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;ecs&#x2F;events&#x2F;">
                                                        
                                                        Events
                                                    </a>
                                                </li>
                                            
                                                <li >
                                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;ecs&#x2F;topics&#x2F;">
                                                        
                                                        Topics
                                                    </a>
                                                </li>
                                            
                                                <li >
                                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;ecs&#x2F;change-detection&#x2F;">
                                                        
                                                        Change Detection
                                                    </a>
                                                </li>
                                            
                                                <li >
                                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;ecs&#x2F;performance&#x2F;">
                                                        
                                                        Performance
                                                    </a>
                                                </li>
                                            
                                        </ul>
                                    
                                </li>
                            
                                
                                <li >
                                    
                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;networking&#x2F;">
                                        <span>3. </span>
                                        <strong>Networking</strong>
                                    </a>
                                    
                                </li>
                            
                                
                                <li >
                                    
                                    <a href="https:&#x2F;&#x2F;javelin.games&#x2F;resources&#x2F;">
                                        <span>4. </span>
                                        <strong>Resources</strong>
                                    </a>
                                    
                                </li>
                            
                        
                    </ul>
                </nav>
                
                
            </div>

            <div class="page">
                <div class="page__content">
                    
                    <div class="search-container">
                        <input id="search" type="search" placeholder="Search..">
                        <div class="search-results">
                            <div class="search-results__header"></div>
                            <ul class="search-results__items"></ul>
                        </div>
                    </div>
                    
                    <div class="book-content">
                        
<h1>ECS</h1>
<p>This section aims to serve as a quick primer on Entity Component Systems (ECS) and how to think in ECS. The goal is not to belittle other methods of building games or make ECS seem like a panacea, because ECS does come with its own challenges. Godot has a great article about <a href="https://godotengine.org/article/why-isnt-godot-ecs-based-game-engine">why Godot does not use ECS</a> that I recommend you read if you're trying to determine whether or not you should use Javelin.</p>
<aside>
  <p>
    <strong>Tip</strong> — this section contains pseudo-code. Skip to the <a href="/ecs/world">Hello World</a> section if you're ready for real examples.
  </p>
</aside>
<h2 id="building-a-game">Building a Game<a class="zola-anchor" href="#building-a-game" aria-label="Anchor link for: building-a-game"
  >#</a
>
</h2>
<p>A best practice in OOP game development is to favor composition over inheritance when designing game data and behavior. Take the following example, where a <code>Player</code> class accepts <code>Body</code> and <code>Input</code> objects to enhance players with physics properties and input control:</p>
<pre style="background-color:#f6f8f8;">
<code><span style="color:#388282;">class </span><span style="color:#555c64;">Body {
  </span><span style="color:#388282;">readonly </span><span style="color:#555c64;">velocity </span><span style="color:#388282;">= </span><span style="color:#555c64;">{ x: </span><span style="color:#4179ad;">0</span><span style="color:#555c64;">, y: </span><span style="color:#4179ad;">0 </span><span style="color:#555c64;">}
}

</span><span style="color:#388282;">class </span><span style="color:#555c64;">Player {
  </span><span style="color:#388282;">private </span><span style="color:#555c64;">body</span><span style="color:#388282;">: </span><span style="color:#555c64;">Body
  </span><span style="color:#388282;">private </span><span style="color:#555c64;">input</span><span style="color:#388282;">: </span><span style="color:#555c64;">Input

  </span><span style="color:#388282;">constructor</span><span style="color:#555c64;">(</span><span style="color:#8a6c3c;">body</span><span style="color:#388282;">: </span><span style="color:#555c64;">Body, </span><span style="color:#8a6c3c;">input</span><span style="color:#388282;">: </span><span style="color:#555c64;">Input) {
    this.body </span><span style="color:#388282;">= </span><span style="color:#555c64;">body
    this.input </span><span style="color:#388282;">= </span><span style="color:#555c64;">input
  }

  jump() {
    this.body.velocity[</span><span style="color:#4179ad;">1</span><span style="color:#555c64;">] </span><span style="color:#388282;">+= </span><span style="color:#4179ad;">1
  </span><span style="color:#555c64;">}

  update() {
    </span><span style="color:#388282;">if </span><span style="color:#555c64;">(this.input.key(</span><span style="color:#4179ad;">&quot;space&quot;</span><span style="color:#555c64;">)) {
      this.jump()
    }
  }
}

</span><span style="color:#388282;">const </span><span style="color:#555c64;">player </span><span style="color:#388282;">= new </span><span style="color:#555c64;">Player(</span><span style="color:#388282;">new </span><span style="color:#555c64;">Body(), </span><span style="color:#388282;">new </span><span style="color:#555c64;">Input())

setInterval(() </span><span style="color:#388282;">=&gt; </span><span style="color:#555c64;">{
  player.update()
}, </span><span style="color:#4179ad;">16.66666</span><span style="color:#555c64;">)
</span></code></pre>
<p>When the player presses the spacebar on their keyboard, <code>player.jump()</code> is called, and the physics body jumps! Easy enough.</p>
<p>What if a player wants to spectate our game instead of controlling a character? In that scenario, it would be unnecessary for <code>Player</code> to care about <code>Body</code>, and we'd need to write code that makes <code>Body</code> an optional dependency of <code>Player</code>, e.g.</p>
<pre style="background-color:#f6f8f8;">
<code><span style="color:#388282;">class </span><span style="color:#555c64;">Player {
  </span><span style="color:#388282;">private </span><span style="color:#555c64;">body</span><span style="color:#388282;">?: </span><span style="color:#555c64;">Body
  ...
  jump() {
    this.body?.velocity[</span><span style="color:#4179ad;">1</span><span style="color:#555c64;">] </span><span style="color:#388282;">+= </span><span style="color:#4179ad;">1
  </span><span style="color:#555c64;">}
}
</span></code></pre>
<p>If there are many states/dependencies a player can have (e.g. spectating, driving a vehicle, etc.), our <code>Player</code> class might explode with complexity. Going even further, <code>Player</code> would need to define all it's possible dependencies in advance, making runtime composition difficult or even impossible.</p>
<h2 id="what-s-an-ecs">What's an ECS?<a class="zola-anchor" href="#what-s-an-ecs" aria-label="Anchor link for: what-s-an-ecs"
  >#</a
>
</h2>
<p>Data and behavior are separate concerns in an ECS. There are three main parts to an ECS: <strong>components</strong> – game data, <strong>entities</strong> – game objects (like a tree, chest, or spawn position), and <strong>systems</strong> – game behavior. As we'll see, this architecture enables runtime composition of behavior that would be tricky to implement in the example above.</p>
<h3 id="components">Components<a class="zola-anchor" href="#components" aria-label="Anchor link for: components"
  >#</a
>
</h3>
<p>In an ECS, components are typically plain objects that contain data and no methods. Ideally all game state lives in components.</p>
<pre style="background-color:#f6f8f8;">
<code><span style="color:#555c64;">player = { name: string }
input  = { jump: boolean }
body   = { velocity: [number, number] }
</span></code></pre><h3 id="entities">Entities<a class="zola-anchor" href="#entities" aria-label="Anchor link for: entities"
  >#</a
>
</h3>
<p>In most ECS implementations (including Javelin) entities are integers that reference a unique array of components. An entity typically represents a game object (like a player, vehicle, or weapon) that could be made up of many components, but sometimes may only reference a single component with the purpose of holding global state. Entities do not store any data of their own, and are fully defined by their component makeup.</p>
<h3 id="systems">Systems<a class="zola-anchor" href="#systems" aria-label="Anchor link for: systems"
  >#</a
>
</h3>
<p>Systems are functions that iterate over entities and modify their components. Systems contain most (ideally all) game logic in an ECS. The following pseudo-code is a depiction of how we might implement the jumping behavior from the above &quot;traditional&quot; example using the ECS pattern.</p>
<pre style="background-color:#f6f8f8;">
<code><span style="color:#555c64;">for entity of (player, input, body)
  if (input[entity].jump)
    body[entity].y += 1
</span></code></pre>
<p>This example shows a system which iterates all components that have a <code>Player</code>, <code>Body</code>, and <code>Input</code> (e.g. a gamepad) component. Each player's input component is checked to determine if the jump key is pressed. If so, we locate the entity's body component and add to it's y-velocity.</p>
<p>Spectators can now be represented with a <code>(Player, Input)</code> entity. Even though they aren't controlling a physics body yet, the <code>Input</code> component might allow them to move the game camera around. If the player chooses to enter the fray, we can insert a <code>Body</code> component into their entity, allowing them to control an actor in the scene.</p>
<pre style="background-color:#f6f8f8;">
<code><span style="color:#555c64;">add(entity, Body)
</span></code></pre>
<p>This pattern can be applied to many types of games. For example, an FPS game might consist of systems that handle physics, user input and movement, projectile collisions, and player inventory.</p>
 
                    </div>
                </div>
            </div>
          </section>
        </main>


        
        
    </body>

</html>
